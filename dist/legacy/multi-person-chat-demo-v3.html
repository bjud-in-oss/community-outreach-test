<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fokuserad Vy Demo</title>
    <style>
        :root {
            --bar-height: 120px;
            --button-height: 50px;
            --input-height: 50px;
            --gap: 10px;
        }

        html, body {
            height: 100%;
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
        }

        .main-view {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr; /* Default to 2 columns */
            gap: 10px;
            padding: 10px;
            overflow: hidden;
        }

        .view-pane {
            position: relative; /* For positioning children */
            display: flex;
            flex-direction: column;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden; /* Panes themselves don't scroll */
        }

        .pane-header {
            padding: 15px;
            font-size: 1.2em;
            font-weight: bold;
            background-color: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            cursor: pointer;
        }

        .pane-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto; /* This part scrolls */
        }
        
        .pane-input-area {
            padding: 10px;
            border-top: 1px solid #dee2e6;
        }

        .pane-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 1em;
            box-sizing: border-box;
        }
        
        .chat-icon-btn {
            position: absolute;
            bottom: 15px;
            right: 15px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background-color: #007bff;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 10;
            transition: opacity 0.2s;
        }

        .view-pane.active .chat-icon-btn {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Chat-specific styles, moved from old file */
        .chat-message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 85%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .message-senior {
            background: #007bff;
            color: white;
            margin-left: auto;
            text-align: right;
        }
        .message-friend {
            background: #e9ecef;
            color: #212529;
            margin-right: auto;
        }
        .chat-sender {
            font-weight: bold;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        /* Styles from original rich view panel */
        .view-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }
        .view-section h3 {
            color: #667eea;
            margin-top: 0;
            font-size: 1.2em;
        }
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #667eea;
        }
        .timeline-item {
            position: relative;
            margin-bottom: 20px;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 8px;
            width: 16px;
            height: 16px;
            background: white;
            border: 3px solid #667eea;
            border-radius: 50%;
        }
        .team-members {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        .team-member {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            background: #f1f3f5;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        @media (min-width: 1200px) {
            .main-view {
                grid-template-columns: 1fr 1fr 1fr; /* 3 columns for very wide screens */
            }
        }

        .bottom-nav {
            display: none; /* Hidden by default */
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 10px;
            background-color: #f8f9fa;
            border-top: 1px solid #dee2e6;
            z-index: 2000;
        }

        .bottom-nav .nav-button {
             height: 50px;
             border: 1px solid #ccc;
             background-color: #e9ecef;
             border-radius: 10px;
             font-size: 16px;
             font-weight: bold;
             cursor: pointer;
        }
        
        .bottom-nav .nav-button.active {
            background-color: #007bff;
            color: white;
        }

        @media (max-width: 1199px) {
            .bottom-nav {
                display: grid;
                grid-template-columns: 1fr 1fr 1fr;
                gap: 10px;
            }
            .main-view {
                /* Add padding to the bottom to avoid being obscured by the nav bar */
                padding-bottom: 80px; 
            }
        }

        /* Popup Selector Styles */
        .popup-selector {
            position: absolute;
            bottom: var(--bar-height);
            left: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.1);
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
        }
        .popup-item {
            padding: 15px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        .popup-item:hover {
            background-color: #f0f2f5;
        }
        .popup-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>

    <div class="main-view" id="mainView">
        <div id="popupSelector" class="popup-selector" style="display: none;"></div>
        <!-- CHATT VIEW (Default) -->
        <div id="viewChat" class="view-pane">
            <div class="pane-header">Chatt</div>
            <div class="pane-content">
                <div class="chat-message message-senior">
                    <div class="chat-sender">Astrid (Du)</div>
                <div>Hej alla! Jag vill att vi ska g칬ra en app som 칬vers칛tter kyrktj칛nsten</div>
            </div>
            <div class="chat-message message-friend">
                <div class="chat-sender">Gunnar (V칛n)</div>
                <div>Vilken bra id칠 Astrid! Vi har ju m친nga i f칬rsamlingen som pratar olika spr친k. Jag kan hj칛lpa till med tekniska saker.</div>
            </div>
            <div class="chat-message">
                <div class="chat-sender">AI-R친dgivare</div>
                <div>Det l친ter som ett fantastiskt projekt! L친t mig hj칛lpa er t칛nka igenom detta. Vilka spr친k t칛nker ni er? Och ska det vara live-칬vers칛ttning eller f칬rberedd text?</div>
            </div>
            <div class="chat-message message-senior">
                <div class="chat-sender">Astrid</div>
                <div>@AI-R친dgivare Vi beh칬ver svenska, engelska, arabiska och somaliska. Helst live s친 alla kan f칬lja med direkt.</div>
            </div>
             <div class="chat-message">
                <div class="chat-sender">AI-Probleml칬sare</div>
                <div>Perfekt! Jag ser en l칬sning: Google Cloud Speech-to-Text f칬r svenska tal, DeepL f칬r 칬vers칛ttning, och en enkel webb-app. Kostnad cirka 40 kr/m친nad. Jules kan bygga detta!</div>
            </div>
            <div class="chat-message message-friend">
                <div class="chat-sender">Gunnar</div>
                <div>@AI-Probleml칬sare Det l친ter rimligt! Kan vi testa det f칬rst innan vi best칛mmer oss?</div>
            </div>
            </div>
            <button class="chat-icon-btn">游눫</button>
            <div class="pane-input-area">
                <input type="text" class="pane-input" placeholder="Skriv i chatten...">
            </div>
        </div>

        <!-- PLAN VIEW (Initially hidden) -->
        <div id="viewPlan" class="view-pane" style="display: none;">
            <div class="pane-header">Plan</div>
            <div class="pane-content">
                <div class="view-section">
                    <h3>V친rt gemensamma m친l</h3>
                <p>H칛r beskriver vi vad vi bygger tillsammans. Just nu 칛r m친let att skapa en app som <strong>칬vers칛tter kyrktj칛nsten i realtid</strong>, s친 att alla i f칬rsamlingen kan k칛nna sig delaktiga, oavsett spr친k.</p>
            </div>

            <div class="view-section">
                <h3>Vi som hj칛lper till</h3>
                <p>Det h칛r 칛r teamet som arbetar med dig f칬r att f칬rverkliga din id칠.</p>
                <div class="team-members">
                    <div class="team-member"><span>Astrid (Du)</span></div>
                    <div class="team-member"><span>Gunnar (Din v칛n)</span></div>
                    <div class="team-member"><span>Jules (Byggaren)</span></div>
                    <div class="team-member"><span>AI-R친dgivare (Bollplanket)</span></div>
                    <div class="team-member"><span>AI-Probleml칬sare (Fixaren)</span></div>
                </div>
            </div>

            <div class="view-section">
                <h3>V친r resa, steg f칬r steg</h3>
                <p>H칛r kan du f칬lja med i arbetet och se vad som h칛nder just nu och vad som kommer h칛rn칛st.</p>
                <div class="timeline">
                    <div class="timeline-item">
                        <strong>Steg 1: Grunden 칛r lagd</strong><br>
                        <small>Vi har byggt ett f칬rsta, fungerande system f칬r 칬vers칛ttning.</small>
                    </div>
                    <div class="timeline-item">
                        <strong>Steg 2: L칛gger till fler spr친k</strong> (P친g친r)<br>
                        <small>Vi arbetar p친 att l칛gga till st칬d f칬r arabiska och somaliska.</small>
                    </div>
                    <div class="timeline-item">
                        <strong>Steg 3: Ett vackert gr칛nssnitt</strong><br>
                        <small>H칛r kommer vi att beh칬va dina tankar om hur appen ska se ut och k칛nnas.</small>
                    </div>
                </div>
            </div>
            </div>
            <button class="chat-icon-btn">游눫</button>
            <div class="pane-input-area">
                <input type="text" class="pane-input" placeholder="Skriv om planen...">
            </div>
        </div>

        <!-- F칐RKLARING VIEW (Initially hidden) -->
        <div id="viewForlaring" class="view-pane" style="display: none;">
            <div class="pane-header">F칬rklaring</div>
            <div class="pane-content">
                <h2>F칬rklaring</h2>
                <p>H칛r kommer f칬rklaringen eller dokumentet att visas.</p>
            </div>
            <button class="chat-icon-btn">游눫</button>
            <div class="pane-input-area">
                <input type="text" class="pane-input" placeholder="St칛ll en fr친ga eller skriv om f칬rklaringen...">
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <button id="btnPlanNav" class="nav-button">Plan</button>
        <button id="btnChatNav" class="nav-button">Chatt</button>
        <button id="btnForlaringNav" class="nav-button">F칬rklaring</button>
    </div>

    <script>
        const mainView = document.getElementById('mainView');
        const viewPanes = {
            plan: document.getElementById('viewPlan'),
            chat: document.getElementById('viewChat'),
            forlaring: document.getElementById('viewForlaring')
        };
        const navButtons = {
            plan: document.getElementById('btnPlanNav'),
            chat: document.getElementById('btnChatNav'),
            forlaring: document.getElementById('btnForlaringNav')
        };
        let activePaneHistory = ['chat', 'plan'];

        // --- Pane Activation (for chat icon) ---
        Object.values(viewPanes).forEach(pane => {
            const chatIcon = pane.querySelector('.chat-icon-btn');
            const inputArea = pane.querySelector('.pane-input-area');
            const inputField = pane.querySelector('.pane-input');

            chatIcon.addEventListener('click', (e) => {
                e.stopPropagation();
                // Deactivate others, activate this one
                Object.values(viewPanes).forEach(p => p.classList.remove('active'));
                pane.classList.add('active');
                inputField.focus();
            });
        });

        // --- Layout and Visibility Logic ---
        function updateLayout() {
            const width = window.innerWidth;
            let columnsToShow = 2; // Default minimum
            if (width >= 1200) {
                columnsToShow = 3;
            }

            // Determine which panes should be visible
            const visiblePaneKeys = activePaneHistory.slice(-columnsToShow);

            // Update main view grid
            mainView.style.gridTemplateColumns = `repeat(${columnsToShow}, 1fr)`;

            // Show/hide panes and update nav buttons
            for (const key in viewPanes) {
                const isVisible = visiblePaneKeys.includes(key);
                viewPanes[key].style.display = isVisible ? 'flex' : 'none';
                if (navButtons[key]) {
                    navButtons[key].classList.toggle('active', isVisible);
                }
            }

            // Show/hide bottom nav
            const bottomNav = document.querySelector('.bottom-nav');
            bottomNav.style.display = columnsToShow < 3 ? 'grid' : 'none';
            mainView.style.paddingBottom = columnsToShow < 3 ? '80px' : '10px';
        }

        // --- Event Listeners ---
        function handleNavClick(viewName) {
            // Move clicked view to the end of the history
            activePaneHistory = activePaneHistory.filter(p => p !== viewName);
            activePaneHistory.push(viewName);
            updateLayout();
        }

        Object.keys(navButtons).forEach(key => {
            navButtons[key].addEventListener('click', () => handleNavClick(key));
        });

        const resizeObserver = new ResizeObserver(updateLayout);
        resizeObserver.observe(document.body);

        // --- Mock Chat Simulation ---
        function sendMessage(pane) {
            const inputField = pane.querySelector('.pane-input');
            const message = inputField.value.trim();
            if (message) {
                const messagesContainer = document.getElementById('viewChat').querySelector('.pane-content');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'chat-message message-senior';
                messageDiv.innerHTML = `<div class="chat-sender">Astrid (Du)</div><div>${message}</div>`;
                messagesContainer.appendChild(messageDiv);
                inputField.value = '';
            }
        }

        Object.values(viewPanes).forEach(pane => {
            const inputField = pane.querySelector('.pane-input');
            inputField.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage(pane);
            });
        });

        // --- Inter-pane communication ---
        const timelineItems = document.querySelectorAll('.timeline-item');
        const explanationContent = document.getElementById('viewForlaring').querySelector('.pane-content');

        const explanations = {
            "Steg 1": "<h2>Detaljer om Steg 1: Grunden</h2><p>Detta involverade att s칛tta upp grundl칛ggande HTML, CSS och JavaScript. Vi skapade de f칬rsta komponenterna och s친g till att allt laddade korrekt.</p>",
            "Steg 2": "<h2>Detaljer om Steg 2: Spr친kst칬d</h2><p>H칛r arbetar vi med att integrera en 칬vers칛ttningstj칛nst. Just nu utv칛rderar vi olika alternativ f칬r att hitta den b칛sta och mest kostnadseffektiva l칬sningen.</p>",
            "Steg 3": "<h2>Detaljer om Steg 3: Gr칛nssnitt</h2><p>Detta 칛r n칛sta stora steg. Vi kommer att beh칬va dina id칠er f칬r att g칬ra appen s친 enkel och trevlig att anv칛nda som m칬jligt. Vi kommer att titta p친 f칛rger, typsnitt och knappar.</p>"
        };

        timelineItems.forEach(item => {
            item.style.cursor = 'pointer';
            item.addEventListener('click', () => {
                const title = item.querySelector('strong').textContent.replace(':', '');
                if (explanations[title]) {
                    explanationContent.innerHTML = explanations[title];
                }
            });
        });
    </script>

</body>
</html>